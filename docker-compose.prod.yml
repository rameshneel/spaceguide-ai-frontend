# Production docker-compose override
# Usage: docker-compose -p spaceguide-frontend-prod -f docker-compose.yml -f docker-compose.prod.yml up -d

services:
  # React Frontend - Prod
  frontend:
    container_name: spaceguide-ai-frontend-prod
    restart: unless-stopped
    ports:
      - "3001:80" # Different port from dev (3000) and staging (3002)
    build:
      args:
        VITE_API_URL: ${VITE_API_URL:-http://localhost:5001/api}
        VITE_STRIPE_PUBLISHABLE_KEY: ${VITE_STRIPE_PUBLISHABLE_KEY:-}
        VITE_APP_NAME: ${VITE_APP_NAME:-SpaceGuideAI}
        VITE_APP_VERSION: ${VITE_APP_VERSION:-1.0.0}
    environment:
      - NGINX_HOST=localhost
      - NGINX_PORT=80
    env_file:
      - ./.env.prod
    volumes:
      # Optional: Mount static files from host (for production)
      # Uncomment below if you want to serve files from host filesystem
      # - ./dist:/usr/share/nginx/html:ro
      # Note: For production, it's recommended to keep files in image (no volume)
    networks:
      - frontend-network-prod
    deploy:
      resources:
        limits:
          cpus: "1"
          memory: 512M
        reservations:
          cpus: "0.5"
          memory: 256M
    logging:
      driver: "json-file"
      options:
        max-size: "10m"
        max-file: "3"

volumes:
  # No volumes needed for frontend (static files in image)
  # Volumes are optional - files are built into Docker image by default

networks:
  frontend-network-prod:
    driver: bridge
